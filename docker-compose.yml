version: '3.8'

services:
  frontend:
    build:
      context: ./frontEnd
    container_name: SIXTALE-frontend
    environment:
      - NODE_OPTIONS=--openssl-legacy-provider
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - /etc/letsencrypt:/etc/letsencrypt
      - /var/lib/letsencrypt:/var/lib/letsencrypt
      - /home/ubuntu/nginx/conf.d:/etc/nginx/conf.d
    networks:
      - backend-network

  backend:
    build:
      context: ./backEnd
    container_name: SIXTALE-backend
    ports:
      - "8888:8888"
    environment:
      SPRING_DATASOURCE_URL: "jdbc:mysql://stg-yswa-kr-practice-db-master.mariadb.database.azure.com:3306/S11P12D108?useUnicode=true&characterEncoding=utf8&serverTimezone=Asia/Seoul&zeroDateTimeBehavior=convertToNull&rewriteBatchedStatements=true"
      SPRING_DATASOURCE_USERNAME: "S11P12D108@stg-yswa-kr-practice-db-master.mariadb.database.azure.com"
      SPRING_DATASOURCE_PASSWORD: "6tfIrEqQzA"
      SPRING_DATA_MONGODB_URI: "mongodb+srv://S11P12D108:nlGDSLzi3v@ssafy.ngivl.mongodb.net/S11P12D108?authSource=admin"
    networks:
      - backend-network
  
networks:
  backend-network:
